version: 0.0.30
jobId: "987"
jobName: Workflow Details
jobType: Source Aligned Data Product
domain: safety
alias: load_workflowdetails
discoveryPort:
  name: Workflow Details
inputPorts:
  - alias: fpay_wflh_1
    isDynamic: true
    tableLocation: s3://msil-cross-account-a-dmm815w1we84nbxaoixydgxordneraps3b-s3alias/sr1/pay_de/fpay_wflh/
    optional:
      persistDataFrame: false
      enableDataReconciliation: false
      enforceSchema: false
      connection: Online Safety S3 Connectivity
      dataSetUrn: urn:dv:dataset:1df3e9ea-f1a3-4bb6-8920-9ff47e72840a
      loggingOptions:
        printSchema: true
        count: true
        showData: true
    type: readDeltaTable
productState:
  isDynamic: true
  alias: load_workflowdetails
  retentionVersions: ""
  logicalSchema:
    properties:
      wflh_request_id:
        type: STRING
        description: Unique id for workflow request
        sourceColumn: wflh_request_id
        sourceTable: fpay_wflh
      wflh_workflow_type:
        type: STRING
        description: Type of workflow
        sourceColumn: wflh_workflow_type
        sourceTable: fpay_wflh
      wflh_action_taken:
        type: STRING
        description: workflow action taken
        sourceColumn: wflh_action_taken
        sourceTable: fpay_wflh
      wflh_action_date:
        type: STRING
        description: action date
        sourceColumn: wflh_action_date
        sourceTable: fpay_wflh
      ETL_Inserted_Date:
        type: DATETIME
        description: " "
        sourceColumn: ""
        sourceTable: ""
      ETL_Modified_Date:
        type: DATETIME
        description: " "
        sourceColumn: ""
        sourceTable: ""
      ETL_Created_By:
        type: STRING
        description: " "
        sourceColumn: ""
        sourceTable: ""
      ETL_Updated_By:
        type: STRING
        description: " "
        sourceColumn: ""
        sourceTable: ""
  stateStoreType: loadDataIceberg
  isProfilingEnabled: true
  updateStrategy: Overwrite
  tableName: msil_dataverse_safety_catalog.Workflow_Details
  warehousePath: s3://msil-dataverse-safety/
  catalogName: glue
  optional:
    persistDataFrame: false
    enableDataReconciliation: false
    enforceSchema: false
    enforceSchemaMethod: Warning
    catalogType: glue
    loggingOptions:
      printSchema: true
      count: true
      showData: true
  refreshInterval: 0 4 * * *
transformation:
  - isDynamic: true
    alias: query_workflowdetails
    description: query_workflowdetails
    sequence: 2
    inputDataFrameList:
      - inputDataFrame: fpay_wflh_1
        tempViewName: fpay_wflh
    query: SELECT DISTINCT      wflh_request_id ,     wflh_workflow_type
      ,     wflh_action_taken ,     wflh_action_date ,     current_date as
      ETL_Inserted_Date,   current_date as ETL_Modified_Date,   'Platform_admin'
      as ETL_Created_By,   'Platform_admin' as
      ETL_Updated_By   from     fpay_wflh WHERE      wflh_workflow_type =
      'SAFETYAUD'
    optional:
      persistDataFrame: false
      loggingOptions:
        printSchema: true
        count: true
        showData: true
    type: operationThroughSqlQuery
controlPort:
  dataQualityRules:
    NullValueCheck:
      productState:
        checks:
          - column: wflh_request_id
        referenceAlias: load_workflowdetails
outputPort:
  subscriptionChannels:
    - channelType: Postgres
      queryType: SQL
    - channelType: Dataproduct
      queryType: SQL
